# hok-daemon
hok-daemon (hands of kindness daemon) - это полностью бесплатное и свободное программное обеспечение с открытым исходным кодом, являющееся демоном для управления телеграм ботом "Руки Добра" (на англ. "Hands of Kindness"). Демон сохраняет и систематизирует проблемы нуждающихся в помощи людей, чтобы другие могли им помочь.

## Требования
- GNU/Linux дистрибутив;
- Доступ к интернету.

## Зависимости
- git;
- make;
- gcc;
- libcurl;
- libcjson.

## Начальная конфигурация
1. Клонировать репозиторий:
```bash
git clone https://github.com/odrawq/hok-daemon.git
```
2. Перейти в репозиторий:
```bash
cd hok-daemon/
```
3. Дать права на выполнение конфигурационному скрипту:
```bash
chmod +x configure.sh
```
4. Сконфигурировать hok-daemon, выполнив конфигурационный скрипт:
```bash
./configure.sh
```
Сначала надо ввести токен телеграм бота, которым будет управлять hok-daemon. Чтобы создать бота и получить его токен, воспользуйтесь ботом [BotFather](https://t.me/BotFather).

Затем надо ввести идентификатор пользователя, который будет администратором бота. Чтобы узнать свой идентификатор, воспользуйтесь ботом [userinfobot](https://t.me/userinfobot).

После того как конфигурация завершится, будет создан файл include/config.h, содержащий в себе макросы введённого вами токена телеграм бота и идентификатора пользователя администратора.

Вы можете поменять значения макросов, выполнив конфигурационный скрипт ещё раз. Если вам нужно поменять значение только одного конкретного макроса, вводить заново остальные не нужно. Достаточно просто нажать Enter, тем самым будет использовано старое значение.

## Сборка, установка и запуск
1. Собрать hok-daemon:
```bash
make
```
2. Установить hok-daemon:
```bash
make install
```
3. Запустить hok-daemon:
```bash
sudo -u hok-daemon hok-daemon
```
Для проведения технических работ запустите hok-daemon в режиме обслуживания. В этом режиме бот будет отправлять пользователям сообщение о проведении технических работ:
```bash
sudo -u hok-daemon hok-daemon -m
```

## Очистка
Удалить файлы после сборки:
```bash
make clean
```

## Удаление
- Удалить hok-daemon:
```bash
make uninstall
```
- Удалить hok-daemon вместе с данными пользователей и логами:
```bash
make purge
```

## Логи и данные
- Файл с логом ошибок находится по пути /var/log/hok-daemon/error_log;
- Файл с логом остальной информации находится по пути /var/log/hok-daemon/info_log;
- Файл с данными пользователей находится по пути /var/lib/hok-daemon/users.json.

## Лицензия
Этот проект лицензирован по лицензии GNU General Public License v3.0 (GPL-3.0) - подробности в файле [LICENSE](LICENSE).
