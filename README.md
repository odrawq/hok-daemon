# hok-daemon
hok-daemon (hands of kindness daemon) - это полностью бесплатное и свободное программное обеспечение с открытым исходным кодом, являющееся демоном для управления телеграм ботом "Руки добра" (на англ. "Hands of kindness").

hok-daemon сохраняет и систематизирует проблемы нуждающихся в помощи людей, чтобы другие могли им помочь. Вы самостоятельно решаете, в каких регионах (например: деревня, город, область или страна) будет использоваться телеграм бот.

## Требования
- GNU/Linux дистрибутив;
- Доступ к интернету.

## Зависимости
- git;
- make;
- gcc;
- libcurl;
- libcjson.

## Начальная конфигурация
1. Клонировать репозиторий:
```bash
git clone https://github.com/odrawq/hok-daemon.git
```
2. Перейти в репозиторий:
```bash
cd hok-daemon/
```
3. Дать права на выполнение конфигурационному скрипту:
```bash
chmod +x configure.sh
```
4. Сконфигурировать hok-daemon, выполнив конфигурационный скрипт:
```bash
./configure.sh
```
Сначала надо ввести токен телеграм бота, которым будет управлять hok-daemon. Чтобы создать бота, воспользуйтесь ботом [BotFather](https://t.me/BotFather). Напишите /start, а затем /newbot. Следуйте дальнейшим инструкциям BotFather. После того как бот будет создан, BotFather напишет вам его токен.

Затем надо ввести идентификатор (id) пользователя, который будет администратором бота. Чтобы узнать свой идентификатор , воспользуйтесь ботом [userinfobot](https://t.me/userinfobot). Напишите /start и затем userinfobot предоставит информацию о вашем аккаунте, включая ваш идентификатор.

После того как конфигурация завершится, будет создан файл include/config.h, содержащий в себе  макросы введённого вами токена телеграм бота и id пользователя администратора.

Вы можете в любое время поменять значения макросов, выполнив ещё раз конфигурационный скрипт. Если вам нужно поменять только один конкретный макрос, вводить заново все значения макросов не нужно. Достаточно просто нажать Enter, тем самым будет использовано старое значение макроса.

## Сборка, установка и запуск
1. Собрать hok-daemon:
```bash
make
```
2. Установить hok-daemon:
```bash
make install
```
3. Запустить hok-daemon от имени пользователя hok-daemon:
```bash
sudo -u hok-daemon hok-daemon
```

## Очистка
Удалить файлы после сборки:
```bash
make clean
```

## Логи и данные
- Файл с логом ошибок находится по пути /var/log/hok-daemon/error_log;
- Файл с логом остальной информации находится по пути /var/log/hok-daemon/info_log;
- Файл с данными пользователей находится по пути /var/lib/hok-daemon/users_data.json.

## Удаление
Удалить hok-daemon:
```bash
make uninstall
```

## Лицензия
Этот проект лицензирован по лицензии GNU General Public License v3.0 (GPL-3.0) - подробности в файле [LICENSE](LICENSE).
